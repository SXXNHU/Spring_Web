# μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ #3

<br/>

# β” λ©μ°¨
  
<br/>

# π’΅ μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

κΈ°μ΅΄μ ν• μΈ μ •μ±…(1000μ› κ³ μ • ν• μΈ)μ„ μƒλ΅μ΄ ν• μΈ μ •μ±…(λ¬Όκ±΄ κ°€κ²©μ 10%)μΌλ΅ λ°”κΎΈλ ¤κ³  ν•λ‹¤.

μ°λ¦¬λ” λ‹¤ν•μ„±μ„ μ΄μ©ν•΄ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ μ¤€μν–λ‹¤κ³  μƒκ°ν•λ”λ°, κ³Όμ—° μ μ§€μΌ°λ”μ§€ μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ μ¶”κ°€ν•λ©° μ•μ•„λ³΄μ.

<br/>

## **RateDiscountPolicy μ½”λ“ μ¶”κ°€**

```java
public class RateDiscountPolicy implements DiscountPolicy{

    private final int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if(member.getGrade() == Grade.VIP){
            return price * 10 / 100;
        }else {
            return 0;
        }
    }
}
```

<br/>

## **μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ **

λ°©κΈ μ¶”κ°€ν• ν• μΈ μ •μ±…μ„ μ μ©ν•λ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈμΈ `OrderServiceImpl` μ½”λ“λ¥Ό κ³ μ³μ•Όν•λ‹¤.

```java
public class OrderServiceImpl implements OrderService {
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

μ—¬κΈ°μ„ λ¬Έμ μ μ„ λ°κ²¬ν•  μ μλ‹¤.

* DIP μ„λ°
  * OrderServiceImpl(ν΄λΌμ΄μ–ΈνΈ)λ” DiscountPolicy μΈν„°νμ΄μ¤(μ—­ν™)μ™€ RateDiscountPolicy(κµ¬ν„ κ°μ²΄)λ¥Ό λ¨λ‘ μμ΅΄ν•κ³  μλ‹¤.

* OCP μ„λ°
  * μ§€κΈ μ½”λ“λ” κΈ°λ¥μ„ ν™•μ •ν•λ©΄, μ„μ™€ κ°™μ΄ κΈ°μ΅΄μ μ½”λ“λ¥Ό λ³€κ²½ν•΄μ•Όν•λ‹¤.

<br/>

# π’΅ κ΄€μ‹¬μ‚¬ λ¶„λ¦¬

μ°λ¦¬λ” λ‹¤ν•μ„±μ„ μ΄μ©ν•΄ μ„¤κ³„λ¥Ό ν–λ”λ°λ„ DIP, OCPλ¥Ό μ„λ°ν•μ€λ‹¤.

**μ΄ λ¬Έμ λ“¤μ€ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ—¬ ν•΄κ²°ν•  μ μλ‹¤.**

* μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν•λ‚μ κ³µμ—°μΌλ΅ μƒκ°

* ν„μ¬ μ½”λ“λ” OrderServiceImpl(ν΄λΌμ΄μ–ΈνΈ)κ°€ μμ΅΄ν•λ” RateDiscountPolicy(κµ¬ν„ κ°μ²΄)λ¥Ό μ§μ ‘ μƒμ„±ν•κ³ , μ‹¤ν–‰ν•λ‹¤.

* λΉ„μ λ¥Ό ν•λ©΄ κΈ°μ΅΄μ—λ” λ‚¨μ μ£ΌμΈκ³µ λ°°μ°κ°€ κ³µμ—°λ„ ν•κ³ , λ™μ‹μ— μ—¬μ μ£ΌμΈκ³µλ„ μ§μ ‘ μ΄λΉ™ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μλ‹¤.
  
* κ³µμ—°μ„ κµ¬μ„±ν•κ³ , λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„­μ™Έν•κ³ , μ§€μ •ν•λ” μ±…μ„μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ κ³µμ—° κΈ°νμ AppConfigλ¥Ό λ“±μ¥μ‹ν‚¨λ‹¤.

* AppConfigλ” μ• ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ° μ„ν•΄, κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•λ”
μ±…μ„μ„ λ¶€μ—¬ν•λ‹¤.

<br/>

## **AppConfig**

```java
public class AppConfig {

    private DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }

    private MemberRepository MemberRepository() {
        return new MemoryMemberRepository();
    }

    public MemberServiceImpl memberService(){
        return new MemberServiceImpl(MemberRepository());
    }

    public OrderServiceImpl orderService(){
        return new OrderServiceImpl(MemberRepository(), discountPolicy());
    }
}
```

* AppConfigλ” μ• ν”λ¦¬μΌ€μ΄μ…μ μ‹¤μ  λ™μ‘μ— ν•„μ”ν• κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•λ‹¤.

  * MemberServiceImpl
  * MemoryMemberRepository
  * OrderServiceImpl
  * FixDiscountPolicy

* AppConfigλ” μƒμ„±ν• κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ νΌλ°μ¤)λ¥Ό μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)ν•΄μ¤€λ‹¤.

* discountPolicy λ” FixDiscountPolicy μ •μ±…μ„ μ‚¬μ©ν•λ‹¤λ” μ—­ν™κ³Ό κµ¬ν„μ„ ν• λμ— λ³Ό μ μκ² μ •λ¦¬ν•΄μ•Όν•λ‹¤.

<br/>

## **Service κµ¬μ΅° λ³€κ²½**

**OrderServiceImpl**

```java
public class OrderServiceImpl implements OrderService{

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    // μƒμ„±μ μ£Όμ…
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

<br/>

**MemberServiceImpl**

```java
public class MemberServiceImpl implements MemberService{
    
    private MemberRepository memberRepository;

    // μƒμ„±μ μ£Όμ…
    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
}
```

* μ„¤κ³„ λ³€κ²½μΌλ΅ MemberServiceImplκ³Ό OrderServiceImplμ€ MemoryMemberRepositoryμ™€ FixDiscountPolicyλ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤.

*  λ‹¨μ§€ MemberRepository, DiscountPolicy (μΈν„°νμ΄μ¤) λ“¤λ§ μμ΅΄ν•λ‹¤.

* MemberServiceImplμ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ¥Ό μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€(AppConfig)μ—μ„ κ²°μ •
λλ‹¤.

* MemberServiceImplμ€ μ΄μ λ¶€ν„° μμ΅΄κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€μ— λ§΅κΈ°κ³  μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤.

<br/>

ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨μΌλ΅ ν‘ν„ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.

![a](https://user-images.githubusercontent.com/55661631/106859705-bd666080-6706-11eb-87fb-5f91aab6cbad.PNG)

<br/>

# π’΅ ν• μΈ μ •μ±… λ³€κ²½

μ²μμΌλ΅ λμ•„κ°€μ„ μ •μ•΅ ν• μΈ μ •μ±…μ„ μ •λ¥ % ν• μΈ μ •μ±…μΌλ΅ λ³€κ²½ν•΄λ³΄μ.

μ–΄λ–¤ λ¶€λ¶„λ§ λ³€κ²½ν•λ©΄ λκ² λ”κ°€?

AppConfigμ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­μΌλ΅ λ¶„λ¦¬λμ—λ‹¤.

λ”°λΌμ„ κµ¬μ„± μμ—­μ κµ¬ν„ κ°μ²΄λ¥Ό λ³€κ²½ν•κΈ°λ§ ν•λ©΄ λλ‹¤.

<br/>

![b](https://user-images.githubusercontent.com/55661631/106860890-5a75c900-6708-11eb-8fb4-f00d11478537.PNG)

<br/>

μ„ κ·Έλ¦Όμ κ³Όμ •μ„ μ½”λ“λ΅ λ‚νƒ€λ‚΄λ©΄ μ•„λμ™€ κ°™λ‹¤.

```java
public class AppConfig {

    private DiscountPolicy discountPolicy() {
        //return new FixDiscountPolicy();
        return new RateDiscountPolicy();
    }

    private MemberRepository MemberRepository() {
        return new MemoryMemberRepository();
    }

    public MemberServiceImpl memberService(){
        return new MemberServiceImpl(MemberRepository());
    }

    public OrderServiceImpl orderService(){
        return new OrderServiceImpl(MemberRepository(), discountPolicy());
    }
}
```

<br/>

## **μ •λ¦¬**

* κ°μ²΄μ μƒμ„±κ³Ό μ—°κ²°μ€ AppConfig κ°€ λ‹΄λ‹Ήν•λ‹¤.

* DIP μ™„μ„± : MemberServiceImpl μ€ MemberRepository μΈ μ¶”μƒμ—λ§ μμ΅΄ν•λ©΄ λλ‹¤. μ΄μ  κµ¬μ²΄ ν΄λμ¤λ¥Ό
λ°λΌλ„ λλ‹¤.

* κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬ : κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• μ΄ λ…ν™•ν λ¶„λ¦¬λμ—λ‹¤.

* appConfig κ°μ²΄λ” memoryMemberRepository κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ·Έ μ°Έμ΅°κ°’μ„ memberServiceImpl μ„
μƒμ„±ν•λ©΄μ„ μƒμ„±μλ΅ μ „λ‹¬ν•λ‹¤.

* ν΄λΌμ΄μ–ΈνΈμΈ memberServiceImpl μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒ κ°™λ‹¤κ³  ν•΄μ„
DI(Dependency Injection) μ°λ¦¬λ§λ΅ **μμ΅΄κ΄€κ³„ μ£Όμ… λλ” μμ΅΄μ„± μ£Όμ…**μ΄λΌ ν•λ‹¤.

<br/>

# π’΅ μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©

## **SRP λ‹¨μΌ μ±…μ„ μ›μΉ™**
ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•λ‹¤.

* ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μλ‹¤.
* SRP λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν–λ‹¤.
* κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ€ AppConfigκ°€ λ‹΄λ‹Ήν•λ‹¤.
* ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ‹¤ν–‰ν•λ” μ±…μ„λ§ λ‹΄λ‹Ήν•λ‹¤.

<br/>

## **DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™**  
ν”„λ΅κ·Έλλ¨Έλ” β€μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤.β€ μμ΅΄μ„± μ£Όμ…μ€ μ΄ μ›μΉ™μ„ λ”°λ¥΄λ” λ°©λ²• μ¤‘
ν•λ‚λ‹¤.

* ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ DiscountPolicy μ¶”μƒν™” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤.
* ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μΈν„°νμ΄μ¤λ§μΌλ΅λ” μ•„λ¬΄κ²ƒλ„ μ‹¤ν–‰ν•  μ μ—†λ‹¤.
* AppConfigκ°€ FixDiscountPolicy κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ€μ‹  μƒμ„±ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“
μ— μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν–λ‹¤. μ΄λ ‡κ²ν•΄μ„ DIP μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ λ¬Έμ λ„ ν•΄κ²°ν–λ‹¤.

<br/>

## **OCP**  
μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤

* μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­μΌλ΅ λ‚λ΄λ‹¤.
* AppConfigκ°€ μμ΅΄κ΄€κ³„λ¥Ό FixDiscountPolicy RateDiscountPolicy λ΅ λ³€κ²½ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”
λ“μ— μ£Όμ…ν•λ―€λ΅ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λλ‹¤.
* μ†ν”„νΈμ›¨μ–΄ μ”μ†λ¥Ό μƒλ΅­κ² ν™•μ¥ν•΄λ„ μ‚¬μ© μ—­μμ λ³€κ²½μ€ λ‹«ν€ μλ‹¤.

<br/>

# π’΅ IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

## **μ μ–΄μ μ—­μ „ IoC(Inversion of Control)**

* κΈ°μ΅΄ ν”„λ΅κ·Έλ¨μ€ ν΄λΌμ΄μ–ΈνΈ κµ¬ν„ κ°μ²΄κ°€ μ¤μ¤λ΅ ν•„μ”ν• μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν–λ‹¤. ν•λ§λ””λ΅ κµ¬ν„ κ°μ²΄κ°€ ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ¤μ¤λ΅ μ΅°μΆ…ν–λ‹¤. κ°λ°μ μ…μ¥μ—μ„λ” μμ—°μ¤λ¬μ΄ νλ¦„μ΄λ‹¤.
  
* λ°λ©΄μ— AppConfigκ°€ λ“±μ¥ν• μ΄ν›„μ— κµ¬ν„ κ°μ²΄λ” μμ‹ μ λ΅μ§μ„ μ‹¤ν–‰ν•λ” μ—­ν• λ§ λ‹΄λ‹Ήν•λ‹¤. ν”„λ΅κ·Έλ¨μ μ 
μ–΄ νλ¦„μ€ μ΄μ  AppConfigκ°€ κ°€μ Έκ°”λ‹¤.

* μ΄λ ‡λ“― ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ§μ ‘ μ μ–΄ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ™Έλ¶€(AppConfig)μ—μ„ κ΄€λ¦¬ν•λ” κ²ƒμ„ μ μ–΄μ μ—­μ „(IoC)μ΄λΌ ν•λ‹¤.

<br/>

## **ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬**

* μ μ–΄μ μ—­μ „(Ioc)κ°€ μΌμ–΄λ‚λ”μ§€λ¥Ό λ³΄κ³  νλ‹¨ν•λ‹¤.

* ν”„λ μ„μ›ν¬κ°€ λ‚΄κ°€ μ‘μ„±ν• μ½”λ“λ¥Ό μ μ–΄ν•κ³ , λ€μ‹  μ‹¤ν–‰ν•λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ λ§λ‹¤.(JUnit)
  
* λ°λ©΄μ— λ‚΄κ°€ μ‘μ„±ν• μ½”λ“κ°€ μ§μ ‘ μ μ–΄μ νλ¦„μ„ λ‹΄λ‹Ήν•λ‹¤λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ μ•„λ‹λΌ λΌμ΄λΈλ¬λ¦¬λ‹¤.

<br/>

## **μμ΅΄κ΄€κ³„ μ£Όμ… DI(Dependency Injection)**

* μ• ν”λ¦¬μΌ€μ΄μ… **μ‹¤ν–‰ μ‹μ (λ°νƒ€μ„)**μ— μ™Έλ¶€μ—μ„ μ‹¤μ  κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ‹¤μ  μμ΅΄κ΄€κ³„κ°€ μ—°κ²° λλ” κ²ƒμ„ **μμ΅΄κ΄€κ³„ μ£Όμ…**μ΄λΌ ν•λ‹¤.

* κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•κ³ , κ·Έ μ°Έμ΅°κ°’μ„ μ „λ‹¬ν•΄μ„ μ—°κ²°λλ‹¤.

* μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , ν΄λΌμ΄μ–ΈνΈκ°€ νΈμ¶ν•λ” λ€μƒμ νƒ€μ… μΈμ¤ν„΄μ¤λ¥Ό λ³€κ²½ν•  μ μλ‹¤.

* μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„(ν΄λΌμ΄μ–ΈνΈ μ½”λ“)λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄κ΄€κ³„λ¥Ό μ‰½κ² λ³€κ²½ν•  μ μλ‹¤.

<br/>

## **IoC μ»¨ν…μ΄λ„, DI μ»¨ν…μ΄λ„**

* AppConfig μ²λΌ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬ν•λ©΄μ„ μμ΅΄κ΄€κ³„λ¥Ό μ—°κ²°ν•΄ μ£Όλ” κ²ƒμ„ IoC μ»¨ν…μ΄λ„ λλ” DI μ»¨ν…μ΄λ„λΌ ν•λ‹¤.

* μμ΅΄κ΄€κ³„ μ£Όμ…μ— μ΄μ μ„ λ§μ¶”μ–΄ μµκ·Όμ—λ” μ£Όλ΅ DI μ»¨ν…μ΄λ„λΌ ν•λ‹¤. Ioc μ»¨ν…μ΄λ„λ” λ„λ¬΄ λ²”μ©μ μΈ λ§μ΄λ‹¤.

* λλ” μ–΄μƒλΈ”λ¬, μ¤λΈμ νΈ ν©ν† λ¦¬ λ“±μΌλ΅ λ¶λ¦¬κΈ°λ„ ν•λ‹¤.

<br/>

# π’΅ μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°