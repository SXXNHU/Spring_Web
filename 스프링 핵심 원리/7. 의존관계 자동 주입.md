# ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ #7

<br/>

# âœ” ëª©ì°¨
* ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•
* ì˜µì…˜ ì²˜ë¦¬
* ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼!
* ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ëœë“œ
* @Autowired í•„ë“œ ëª…, @Qualifier, @Primary
* ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°
* ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map
* ìë™, ìˆ˜ë™ì˜ ì˜¬ë°”ë¥¸ ì‹¤ë¬´ ìš´ì˜ ê¸°ì¤€

<br/>

<br/>

# ğŸ’¡ ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•

ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ ë‹¤ìŒê³¼ ê°™ì´ í¬ê²Œ 4ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.

* ìƒì„±ì ì£¼ì…
* ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)
* í•„ë“œ ì£¼ì…
* ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

<br/>

<br/>

## **1. ìƒì„±ì ì£¼ì…**

* ìƒì„±ìë¥¼ í†µí•´ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•ì´ë‹¤.
* ìƒì„±ì í˜¸ì¶œì‹œì ì— ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤.
* **ë¶ˆë³€, í•„ìˆ˜ ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©ëœë‹¤.**

```java
@Component
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    //ìƒì„±ìê°€ 1ê°œë§Œ ìˆìœ¼ë©´ ìƒëµ ê°€ëŠ¥í•˜ë‹¤.
    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

* ë§Œì•½ ìƒì„±ìê°€ 1ê°œë§Œ ìˆìœ¼ë©´ `@Autowired`ëŠ” ìƒëµì´ ê°€ëŠ¥í•˜ë‹¤.

<br/>

<br/>

## **2. ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)**

* setterë¼ ë¶ˆë¦¬ëŠ” í•„ë“œê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•ì´ë‹¤.
* **ì„ íƒ, ë³€ê²½ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©ëœë‹¤.**
* ìë°”ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì˜ ìˆ˜ì •ì ë©”ì„œë“œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

```java
@Component
public class OrderServiceImpl implements OrderService {
    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

<br/>

<br/>

## **3. í•„ë“œ ì£¼ì…**

* ì´ë¦„ ê·¸ëŒ€ë¡œ í•„ë“œì— ë°”ë¡œ ì£¼ì…í•˜ëŠ” ë°©ë²•ì´ë‹¤.
* ì½”ë“œê°€ ê°„ê²°í•´ì„œ ì¢‹ì•„ë³´ì´ì§€ë§Œ ì™¸ë¶€ì—ì„œ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•´ì„œ í…ŒìŠ¤íŠ¸ í•˜ê¸° í˜ë“¤ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.
* ìˆœìˆ˜ ìë°” í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œëŠ” `@Autowired`ê°€ ë™ì‘í•˜ì§€ ì•Šì•„ í…ŒìŠ¤íŠ¸ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
* DI í”„ë ˆì„ì›Œí¬ê°€ ì—†ìœ¼ë©´ í…ŒìŠ¤íŠ¸ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
* **ì‚¬ìš©í•˜ì§€ ë§ì**
  * ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ì½”ë“œì™€ ê´€ê³„ ì—†ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ
  * ìŠ¤í”„ë§ ì„¤ì •ì„ ëª©ì ìœ¼ë¡œ í•˜ëŠ” `@Configuration` ê°™ì€ ê³³ì—ì„œë§Œ íŠ¹ë³„í•œ ìš©ë„ë¡œ ì‚¬ìš©í•œë‹¤.

```java
@Component
public class OrderServiceImpl implements OrderService {
    @Autowired
    private MemberRepository memberRepository;

    @Autowired
    private DiscountPolicy discountPolicy;
}
```

<br/>

<br/>

## **4. ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…**

* ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.
* ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

```java
@Component
public class OrderServiceImpl implements OrderService {
    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

<br/>

<br/>

<br/>

# ğŸ’¡ ì˜µì…˜ ì²˜ë¦¬

ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì—ëŸ¬ê°€ ë‚œë‹¤.  
í•˜ì§€ë§Œ ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ í•  ë•Œê°€ ìˆë‹¤.

ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

* `@Autowired(required=false)` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œì´ ì•ˆëœë‹¤. ìƒì„±ì ì£¼ì…ì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
* `@Nullable` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ nullì´ ì…ë ¥ëœë‹¤. ìƒì„±ì ìë™ ì£¼ì…ì—ì„œ íŠ¹ì • í•„ë“œì—ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
* `Optional<>` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ `Optional.empty` ê°€ ì…ë ¥ëœë‹¤. ìƒì„±ì ìë™ ì£¼ì…ì—ì„œ íŠ¹ì • í•„ë“œì—ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```java
@Autowired(required = false)
public void setNoBean1(Member member){
    System.out.println("Bean1 = " + member);
}

@Autowired
public void setNoBean2(@Nullable Member member){
    System.out.println("Bean2 = " + member);
}

@Autowired
public void setNoBean3(Optional<Member> member){
    System.out.println("Bean3 = " + member);
}
```

ì¶œë ¥ê²°ê³¼
```
Bean2 = null
Bean3 = Optional.empty
```

* memberëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹ˆë‹¤. ë”°ë¼ì„œ setNoBean1 ë©”ì„œë“œëŠ” í˜¸ì¶œì´ ì•ˆëœë‹¤.

<br/>

<br/>

<br/>

# ğŸ’¡ ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•˜ë¼!

ê³¼ê±°ì—ëŠ” ìˆ˜ì •ì ì£¼ì…ê³¼ í•„ë“œ ì£¼ì…ì„ ë§ì´ ì‚¬ìš©í–ˆì§€ë§Œ, ìµœê·¼ì—ëŠ” ìŠ¤í”„ë§ì„ í¬í•¨í•œ DI í”„ë ˆì„ì›Œí¬ ëŒ€ë¶€ë¶„ì´
ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•œë‹¤. ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

<br/>

## **1. ë¶ˆë³€**

* ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ í•œë²ˆ ì¼ì–´ë‚˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œì‹œì ê¹Œì§€ ë³€ê²½í•  ì¼ì´ ì—†ë‹¤. ì˜¤íˆë ¤ ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ëŠ” ë³€í•˜ë©´ ì•ˆëœë‹¤. (ë¶ˆë³€)
* ìˆ˜ì •ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´, setXXX ë©”ì„œë“œë¥¼ publicìœ¼ë¡œ ì—´ì–´ë‘¬ì•¼í•œë‹¤.
* ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ ë³€ê²½í•  ìˆ˜ ìˆê³ , ë³€ê²½í•˜ë©´ ì•ˆë˜ëŠ” ë©”ì„œë“œë¥¼ ì—´ì–´ë‘ëŠ” ê²ƒì€ ì¢‹ì€ ì„¤ê³„ ë°©ë²•ì´ ì•„ë‹ˆë‹¤.
* ìƒì„±ì ì£¼ì…ì€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ë¯€ë¡œ ì´í›„ì— í˜¸ì¶œë˜ëŠ” ì¼ì´ ì—†ë‹¤. ë”°ë¼ì„œ ë¶ˆë³€í•˜ê²Œ ì„¤ê³„í• 
ìˆ˜ ìˆë‹¤

<br/>

<br/>

## **2. ëˆ„ë½**

í”„ë ˆì„ì›Œí¬ ì—†ì´ ìˆœìˆ˜í•œ ìë°” ì½”ë“œë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²½ìš°ì— 

ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒì²˜ëŸ¼ ì£¼ì… ë°ì´í„°ë¥¼ ëˆ„ë½ í–ˆì„ ë•Œ ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

ê·¸ë¦¬ê³  IDEì—ì„œ ë°”ë¡œ ì–´ë–¤ ê°’ì„ í•„ìˆ˜ë¡œ ì£¼ì…í•´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.

<br/>

**OrderServiceImpl.java**
```java
@Component
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    //ìƒì„±ìê°€ 1ê°œë§Œ ìˆìœ¼ë©´ ìƒëµ ê°€ëŠ¥í•˜ë‹¤.
    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

<br/>

**OrderServiceImplTest.java**
```java
@Test
void createOrder() {
    OrderServiceImpl orderService = new OrderServiceImpl(); // ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë‚˜íƒ€ë‚œë‹¤.
    orderService.createOrder(1L, "itemA", 10000);
}
```

<br/>

<br/>

## **3. final í‚¤ì›Œë“œ**

ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í•„ë“œì— final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

ê·¸ë˜ì„œ ìƒì„±ìì—ì„œ í˜¹ì‹œë¼ë„ ê°’ì´ ì„¤ì •ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ë§‰ì•„ì¤€ë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ë³´ì.

```java
@Component
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    //ì»´íŒŒì¼ ì˜¤ë¥˜ ë°œìƒ
    }
}
```

í•„ìˆ˜ í•„ë“œì¸ `discountPolicy` ì— ê°’ì„ ì„¤ì •í•´ì•¼ í•˜ëŠ”ë°, ì´ ë¶€ë¶„ì´ ëˆ„ë½ë˜ì—ˆë‹¤. ìë°”ëŠ” ì»´íŒŒì¼ ì‹œ
ì ì— ë‹¤ìŒ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.

**ê¸°ì–µí•˜ì! ì»´íŒŒì¼ ì˜¤ë¥˜ëŠ” ì„¸ìƒì—ì„œ ê°€ì¥ ë¹ ë¥´ê³ , ì¢‹ì€ ì˜¤ë¥˜ë‹¤!**

<br/>

> ### **ì°¸ê³ **
> ìˆ˜ì •ì ì£¼ì…ì„ í¬í•¨í•œ ë‚˜ë¨¸ì§€ ì£¼ì… ë°©ì‹ì€ ëª¨ë‘ ìƒì„±ì ì´í›„ì— í˜¸ì¶œë˜ë¯€ë¡œ, í•„ë“œì— `final` í‚¤ì›Œë“œë¥¼
ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì˜¤ì§ ìƒì„±ì ì£¼ì… ë°©ì‹ë§Œ `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

<br/>

<br/>

## **4. ì •ë¦¬**

* ìƒì„±ì ì£¼ì… ë°©ì‹ì„ ì„ íƒí•˜ëŠ” ì´ìœ ëŠ” ì—¬ëŸ¬ê°€ì§€ê°€ ìˆì§€ë§Œ, í”„ë ˆì„ì›Œí¬ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ìˆœìˆ˜í•œ ìë°” ì–¸ì–´ì˜
íŠ¹ì§•ì„ ì˜ ì‚´ë¦¬ëŠ” ë°©ë²•ì´ê¸°ë„ í•˜ë‹¤.

* ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ê³ , í•„ìˆ˜ ê°’ì´ ì•„ë‹Œ ê²½ìš°ì—ëŠ” ìˆ˜ì •ì ì£¼ì… ë°©ì‹ì„ ì˜µì…˜ìœ¼ë¡œ ë¶€ì—¬í•˜ë©´ ëœë‹¤. ìƒì„±ì ì£¼ì…ê³¼ ìˆ˜ì •ì ì£¼ì…ì„ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
* í•­ìƒ ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼! ê·¸ë¦¬ê³  ê°€ë” ì˜µì…˜ì´ í•„ìš”í•˜ë©´ ìˆ˜ì •ì ì£¼ì…ì„ ì„ íƒí•´ë¼. í•„ë“œ ì£¼ì…ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²Œ ì¢‹ë‹¤.

<br/>

<br/>

<br/>

# ğŸ’¡ ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ë Œë“œ

ë§‰ìƒ ê°œë°œì„ í•´ë³´ë©´, ëŒ€ë¶€ë¶„ì´ ë‹¤ ë¶ˆë³€ì´ë‹¤. ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±ìì— `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

ê·¸ëŸ°ë° ìƒì„±ìë„ ë§Œë“¤ê³ , íŒŒë¼ë¯¸í„°ë„ ë§Œë“¤ê³ , ëŒ€ì…í•˜ëŠ” ì½”ë“œë„ ë§Œë“¤ì–´ì•¼í•œë‹¤.

ë¡¬ë³µì€ ì´ì™€ ê°™ì€ ê¸°ë³¸ ì½”ë“œë¥¼ í™• ì¤„ì—¬ì¤€ë‹¤.

<br/>

**ë³€ê²½ ì „**
```java
@Component
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
    }
}
```

<br/>

**ë³€ê²½ í›„**
```java
@Component
@RequiredArgsConstructor
    public class OrderServiceImpl implements OrderService {
        private final MemberRepository memberRepository;
        private final DiscountPolicy discountPolicy;
}
```

`@RequiredArgsConstructor` ì–´ë…¸í…Œì´ì…˜(ë¡¬ë³µ ë¼ì´ë¸ŒëŸ¬ë¦¬)ì€ `final` ì´ ë¶™ì€ í•„ë“œì— í•œí•´ì„œ ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.

ë‹¨ ìƒì„±ìê°€ í•˜ë‚˜ì¼ ë•Œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. `@Autowired`ë¥¼ ìƒëµí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ì»´íŒŒì¼ëœ í´ë˜ìŠ¤íŒŒì¼ì„ ì—´ì–´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±ìê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br/>

**í´ë˜ìŠ¤íŒŒì¼**

![a](https://user-images.githubusercontent.com/55661631/107879524-a4d32300-6f1c-11eb-8b67-029151509354.PNG)

<br/>

<br/>

<br/>

# ğŸ’¡ ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ - ë¬¸ì œ

`@Autowired` ëŠ” íƒ€ì…(Type)ìœ¼ë¡œ ì¡°íšŒí•œë‹¤.

ë”°ë¼ì„œ í•´ë‹¹ íƒ€ì…ì˜ ì„ íƒëœ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

<br/>

ë‹¤ìŒê³¼ ê°™ì´ `DiscountPolicy` ì˜ í•˜ìœ„ íƒ€ì…ì¸ `FixDiscountPolicy` , `RateDiscountPolicy` ë‘˜ë‹¤ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì„ ì–¸í•˜ê³ ..
```java
@Component
public class FixDiscountPolicy implements DiscountPolicy {}
```

```java
@Component
public class RateDiscountPolicy implements DiscountPolicy {}
```

<br/>

ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…ì„ ì‹¤í–‰í•˜ë©´..

```java
@Autowired
private DiscountPolicy discountPolicy
```

<br/>

`NoUniqueBeanDefinitionException` ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

```
NoUniqueBeanDefinitionException: No qualifying bean of type
'hello.core.discount.DiscountPolicy' available: expected single matching bean
but found 2: fixDiscountPolicy,rateDiscountPolicy
```

